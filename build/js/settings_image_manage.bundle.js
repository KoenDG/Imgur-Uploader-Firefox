(()=>{var e={546:(e,r,t)=>{"use strict";var o=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}(),n=t(770);e.exports=function(){function e(){var r=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),browser.storage.local.get("firefox-uploader-client-id").then((function(e){var t=["a6bebdd6a51f656","f752792c52f4cdf","474d8a50e7e752d","9089d7837e30269","6c6fa522da181b8","bbf63f907ae5614","480391db79e87b6","ea76f402e22007a"];void 0!==e["firefox-uploader-client-id"]?(r.clientID=e["firefox-uploader-client-id"],console.log(e["firefox-uploader-client-id"])):r.clientID=t[Math.floor(Math.random()*t.length)],console.log(r.clientID)}))}return o(e,[{key:"update",value:function(){var e=this;browser.storage.local.get("firefox-uploader-client-id").then((function(r){var t=["a6bebdd6a51f656","f752792c52f4cdf","474d8a50e7e752d","9089d7837e30269","6c6fa522da181b8","bbf63f907ae5614","480391db79e87b6","ea76f402e22007a"];void 0!==r["firefox-uploader-client-id"]?(e.clientID=r["firefox-uploader-client-id"],console.log(r["firefox-uploader-client-id"])):e.clientID=t[Math.floor(Math.random()*t.length)],console.log(e.clientID)}))}},{key:"uuid",value:function(){var e=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===r?t:3&t|8).toString(16)}))}},{key:"imageReader",value:function(e){var r=this,t=new FileReader;return new Promise((function(o,n){t.onload=function(e){o(e.target.result.split("base64,")[1])},t.onerror=function(){return n(r)},t.readAsDataURL(e)}))}},{key:"uploadToImgur",value:function(e){var r=this,t=this;return new Promise((function(o,a){console.log(r),console.log(t.uuid());var i={url:"https://api.imgur.com/3/image",headers:{authorization:"Client-ID "+t.clientID},json:{image:e}};console.log(i),n.post(i,(function(e,r,t){console.log(t.data),t.data.error?a(t.data):o(t.data)}))}))}},{key:"uploader",value:function(e){return this.imageReader(e).then(this.uploadToImgur.bind(this))}},{key:"remove",value:function(e){var r=this;return new Promise((function(t,o){var a={method:"delete",url:"https://api.imgur.com/3/image/"+e,headers:{authorization:"Client-ID "+r.clientID}};console.log(a),n(a,(function(e,r,n){var a=JSON.parse(n);a.data?t(a):o(a)}))}))}}]),e}()},19:e=>{"use strict";var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}();e.exports=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),browser.storage.local.get("firefox-uploader-imgur").then((function(e){0==Object.getOwnPropertyNames(e).length&&(console.log("test"),browser.storage.local.set({"firefox-uploader-imgur":[]}))}))}return r(e,[{key:"add",value:function(e){return new Promise((function(r,t){browser.storage.local.get("firefox-uploader-imgur").then((function(t){var o=t["firefox-uploader-imgur"];e.viewable=!0,o.push(e),console.log(o),browser.storage.local.set({"firefox-uploader-imgur":o}).then((function(){r("test")}))}))}))}},{key:"remove",value:function(e){browser.storage.local.get("firefox-uploader-imgur").then((function(r){var t=[],o=!0,n=!1,a=void 0;try{for(var i,l=r["firefox-uploader-imgur"][Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var u=i.value;u.id!=e&&t.push(u)}}catch(e){n=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(n)throw a}}browser.storage.local.set({"firefox-uploader-imgur":t})}))}},{key:"change",value:function(e,r){!e instanceof Array&&(e=[e]),browser.storage.local.get("firefox-uploader-imgur").then((function(t){var o=[],n=!0,a=!1,i=void 0;try{for(var l,u=t["firefox-uploader-imgur"][Symbol.iterator]();!(n=(l=u.next()).done);n=!0){var s=l.value;if(e.indexOf(s.id)>=0){for(var d in console.log(e),console.log(r),r)r.hasOwnProperty(d)&&(s[d]=r[d]);console.log(s),o.push(s)}else o.push(s)}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}browser.storage.local.set({"firefox-uploader-imgur":o})}))}},{key:"removeAll",value:function(){browser.storage.local.set({"firefox-uploader-imgur":[]})}}]),e}()},770:function(e,r){var t,o;t=function(){var e=XMLHttpRequest;if(!e)throw new Error("missing XMLHttpRequest");r.log={trace:o,debug:o,info:o,warn:o,error:o};function r(a,i){if("function"!=typeof i)throw new Error("Bad callback given: "+i);if(!a)throw new Error("No options given");var l=a.onResponse;if((a="string"==typeof a?{uri:a}:JSON.parse(JSON.stringify(a))).onResponse=l,a.verbose&&(r.log=function(){var e,r,t={},a=["trace","debug","info","warn","error"];for(r=0;r<a.length;r++)t[e=a[r]]=o,"undefined"!=typeof console&&console&&console[e]&&(t[e]=n(console,e));return t}()),a.url&&(a.uri=a.url,delete a.url),!a.uri&&""!==a.uri)throw new Error("options.uri is a required argument");if("string"!=typeof a.uri)throw new Error("options.uri must be a string");for(var u=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],s=0;s<u.length;s++)if(a[u[s]])throw new Error("options."+u[s]+" is not supported");if(a.callback=i,a.method=a.method||"GET",a.headers=a.headers||{},a.body=a.body||null,a.timeout=a.timeout||r.DEFAULT_TIMEOUT,a.headers.host)throw new Error("Options.headers.host is not supported");a.json&&(a.headers.accept=a.headers.accept||"application/json","GET"!==a.method&&(a.headers["content-type"]="application/json"),"boolean"!=typeof a.json?a.body=JSON.stringify(a.json):"string"!=typeof a.body&&(a.body=JSON.stringify(a.body)));var d=function(e){var r=[];for(var t in e)e.hasOwnProperty(t)&&r.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return r.join("&")};if(a.qs){var c="string"==typeof a.qs?a.qs:d(a.qs);-1!==a.uri.indexOf("?")?a.uri=a.uri+"&"+c:a.uri=a.uri+"?"+c}if(a.form){if("string"==typeof a.form)throw"form name unsupported";if("POST"===a.method){var f=(a.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(a.headers["content-type"]=f,f){case"application/x-www-form-urlencoded":a.body=d(a.form).replace(/%20/g,"+");break;case"multipart/form-data":var g=function(e){var r={};r.boundry="-------------------------------"+Math.floor(1e9*Math.random());var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push("--"+r.boundry+'\nContent-Disposition: form-data; name="'+o+'"\n\n'+e[o]+"\n");return t.push("--"+r.boundry+"--"),r.body=t.join(""),r.length=r.body.length,r.type="multipart/form-data; boundary="+r.boundry,r}(a.form);a.body=g.body,a.headers["content-type"]=g.type;break;default:throw new Error("unsupported encoding:"+f)}}}return a.onResponse=a.onResponse||o,!0===a.onResponse&&(a.onResponse=i,a.callback=o),!a.headers.authorization&&a.auth&&(a.headers.authorization="Basic "+function(e){var r,t,o,n,a,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,u=0,s="",d=[];if(!e)return e;do{r=(a=e.charCodeAt(l++)<<16|e.charCodeAt(l++)<<8|e.charCodeAt(l++))>>18&63,t=a>>12&63,o=a>>6&63,n=63&a,d[u++]=i.charAt(r)+i.charAt(t)+i.charAt(o)+i.charAt(n)}while(l<e.length);switch(s=d.join(""),e.length%3){case 1:s=s.slice(0,-2)+"==";break;case 2:s=s.slice(0,-1)+"="}return s}(a.auth.username+":"+a.auth.password)),function(o){var n=new e,a=!1,i=function(e){var r,t=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{r=location.href}catch(e){(r=document.createElement("a")).href="",r=r.href}var o=t.exec(r.toLowerCase())||[],n=t.exec(e.toLowerCase());return!(!n||n[1]==o[1]&&n[2]==o[2]&&(n[3]||("http:"===n[1]?80:443))==(o[3]||("http:"===o[1]?80:443)))}(o.uri),l="withCredentials"in n;if(t+=1,n.seq_id=t,n.id=t+": "+o.method+" "+o.uri,n._id=n.id,i&&!l){var u=new Error("Browser does not support cross-origin request: "+o.uri);return u.cors="unsupported",o.callback(u,n)}function s(){a=!0;var e=new Error("ETIMEDOUT");return e.code="ETIMEDOUT",e.duration=o.timeout,r.log.error("Timeout",{id:n._id,milliseconds:o.timeout}),o.callback(e,n)}n.timeoutTimer=setTimeout(s,o.timeout);var d={response:!1,loading:!1,end:!1};return n.onreadystatechange=c,n.open(o.method,o.uri,!0),i&&(n.withCredentials=!!o.withCredentials),n.send(o.body),n;function c(t){if(a)return r.log.debug("Ignoring timed out state change",{state:n.readyState,id:n.id});if(r.log.debug("State change",{state:n.readyState,id:n.id,timed_out:a}),n.readyState===e.OPENED)for(var i in r.log.debug("Request started",{id:n.id}),o.headers)n.setRequestHeader(i,o.headers[i]);else n.readyState===e.HEADERS_RECEIVED?f():n.readyState===e.LOADING?(f(),g()):n.readyState===e.DONE&&(f(),g(),p())}function f(){if(!d.response){if(d.response=!0,r.log.debug("Got response",{id:n.id,status:n.status}),clearTimeout(n.timeoutTimer),n.statusCode=n.status,i&&0==n.statusCode){var e=new Error("CORS request rejected: "+o.uri);return e.cors="rejected",d.loading=!0,d.end=!0,o.callback(e,n)}o.onResponse(null,n)}}function g(){d.loading||(d.loading=!0,r.log.debug("Response body loading",{id:n.id}))}function p(){if(!d.end){if(d.end=!0,r.log.debug("Request done",{id:n.id}),n.body=n.responseText,o.json)try{n.body=JSON.parse(n.responseText)}catch(e){return o.callback(e,n)}o.callback(null,n,n.body)}}}(a)}var t=0;function o(){}function n(e,r){return function(t,o){return"object"==typeof o&&(t+=" "+JSON.stringify(o)),e[r].call(e,t)}}return r.withCredentials=!1,r.DEFAULT_TIMEOUT=18e4,r.defaults=function(e,t){var o=function(r){return function(t,o){for(var n in t="string"==typeof t?{uri:t}:JSON.parse(JSON.stringify(t)),e)void 0===t[n]&&(t[n]=e[n]);return r(t,o)}},n=o(r);return n.get=o(r.get),n.post=o(r.post),n.put=o(r.put),n.head=o(r.head),n},["get","put","post","head"].forEach((function(e){var t=e.toUpperCase();r[e.toLowerCase()]=function(e){"string"==typeof e?e={method:t,uri:e}:(e=JSON.parse(JSON.stringify(e))).method=t;var o=[e].concat(Array.prototype.slice.apply(arguments,[1]));return r.apply(this,o)}})),r.couch=function(e,t){return"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,t=t||o,r(e,(function(e,r,o){if(e)return t(e,r,o);if((r.statusCode<200||r.statusCode>299)&&o.error){for(var n in e=new Error("CouchDB error: "+(o.error.reason||o.error.error)),o)e[n]=o[n];return t(e,r,o)}return t(e,r,o)}))},r},void 0===(o=t.apply(r,[]))||(e.exports=o)}},r={};function t(o){var n=r[o];if(void 0!==n)return n.exports;var a=r[o]={exports:{}};return e[o].call(a.exports,a,a.exports,t),a.exports}(()=>{"use strict";$(document).foundation();var e=t(546),r=t(19),o=new e,n=new r,a=(location.hash||"#1").slice(1),i=0,l=15,u=!1;function s(e,r){return e.className.split(" ").indexOf(r)>-1}function d(){document.getElementById("image-list").innerHTML="",document.getElementById("image-page").innerHTML="",browser.storage.local.get("firefox-uploader-imgur").then((function(e){console.log(e);var r=e["firefox-uploader-imgur"].reverse(),t=Math.ceil(r.length/l);if(t>0){if(t>7)for(var o=a<=4?1:a+3>t?t-6:a-3,n=o+6,i=o;i<=n;i++)$(document.getElementById("image-page")).append('<li><a class="page-href"  attr-page="'+i+'"  aria-label="Page '+i+'">'+i+"</a></li>");else for(var u=1;u<=t;u++)$(document.getElementById("image-page")).append('<li><a class="page-href"  attr-page="'+u+'"  aria-label="Page '+u+'">'+u+"</a></li>");$(document.querySelector("[aria-label='Page "+a+"']")).parent().addClass("current");var s=!0,d=!1,c=void 0;try{for(var f,g=e["firefox-uploader-imgur"].slice((a-1)*l,a*l)[Symbol.iterator]();!(s=(f=g.next()).done);s=!0){var p=f.value;console.log(p),null!=p&&null!=p.link&&$(document.getElementById("image-list")).append('                    <div class="cell">                      <div class="card">                        <img src="'+p.link+'">                        <div class="card-section">                            <h6>'+p.link+'</h6>                            <button type="button" class="alert button delete float-right" data-id="'+p.id+'" data-delete="'+p.deletehash+'">Delete From Imgur</button>                        </div>                      </div>                    </div>                ')}}catch(e){d=!0,c=e}finally{try{!s&&g.return&&g.return()}finally{if(d)throw c}}}}))}function c(){document.getElementById("image-list").innerHTML="",document.getElementById("image-page").innerHTML="",browser.storage.local.get("firefox-uploader-auth").then((function(e){console.log(e);var r=e["firefox-uploader-auth"].access_token;console.log(r),$.ajax({url:"https://api.imgur.com/3/account/me/images",headers:{Authorization:"Bearer "+r}}).done((function(e){var r=e.data,t=Math.ceil(r.length/l);if(t>0){if(console.log("test"),t>7)for(var o=a<=4?1:a+3>t?t-6:a-3,n=o+6,i=o;i<=n;i++)$(document.getElementById("image-page")).append('<li><a class="page-href"  attr-page="'+i+'" aria-label="Page '+i+'">'+i+"</a></li>");else for(var u=1;u<=t;u++)$(document.getElementById("image-page")).append('<li><a class="page-href" attr-page="'+u+'" aria-label="Page '+u+'">'+u+"</a></li>");$(document.querySelector("[aria-label='Page "+a+"']")).parent().addClass("current");var s=!0,d=!1,c=void 0;try{for(var f,g=r.slice((a-1)*l,a*l)[Symbol.iterator]();!(s=(f=g.next()).done);s=!0){var p=f.value;console.log(p),null!=p&&null!=p.link&&$(document.getElementById("image-list")).append('                        <div class="cell">                          <div class="card">                            <img src="'+p.link+'">                            <div class="card-section">                                <h6>'+p.link+'</h6>                                <button type="button" class="alert button delete float-right" data-id="'+p.id+'" data-delete="'+p.deletehash+'">Delete From Imgur</button>                            </div>                          </div>                        </div>                    ')}}catch(e){d=!0,c=e}finally{try{!s&&g.return&&g.return()}finally{if(d)throw c}}}}))}))}browser.storage.local.get("firefox-uploader-client-id").then((function(e){void 0!==e["firefox-uploader-client-id"]&&(document.querySelector("#client-id").value=e["firefox-uploader-client-id"])})),browser.storage.local.get("firefox-uploader-auth").then((function(e){console.log(e),e["firefox-uploader-auth"].access_token?u=!0:(console.log("out"),$("#account-image").css({color:"grey",cursor:"default"}))})),d(),document.getElementById("local-image").addEventListener("click",(function(){a=1,i=0,d()})),document.getElementById("account-image").addEventListener("click",(function(){1==u&&(a=1,i=1,c())})),document.addEventListener("click",(function(e){s(e.target,"delete")?o.remove(e.target.getAttribute("data-delete")).then((function(r){r.success&&(n.remove(e.target.getAttribute("data-id")),e.target.parentNode.parentNode.parentNode.style.display="none")})):s(e.target,"page-href")&&(a=parseInt(e.target.getAttribute("attr-page")),console.log(i),console.log(a),0==i?d():c(),console.log(e.target))}),!1)})()})();
//# sourceMappingURL=settings_image_manage.bundle.js.map